---
author: Sat Naing
pubDatetime: 2022-08-21T04:58:53Z
title: npm run buildå’Œastro-paperé¡¹ç›®éƒ¨ç½²vercelæ—¶å¯èƒ½é‡åˆ°çš„é—®é¢˜
slug: npm run buildå’Œastro-paperé¡¹ç›®éƒ¨ç½²vercelæ—¶å¯èƒ½é‡åˆ°çš„é—®é¢˜
featured: true
draft: false
tags:
  - configuration
  - docs
description: Problems you may encounter when deploying vercel with npm run build and astro-paper project.
---
1. åœ¨npm run buildé¡¹ç›®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé‡åˆ°ä»¥ä¸‹æŠ¥é”™
```html
'cp' ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤ï¼Œä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åº
æˆ–æ‰¹å¤„ç†æ–‡ä»¶ã€‚
```
è¿™ä¸ªæŠ¥é”™æ˜¯å› ä¸ºæ“ä½œç³»ç»Ÿä¸æ”¯æŒnpm run buildè¿‡ç¨‹ä¸­æ¶‰åŠçš„cpï¼Œå¹¶ä¸”ä»è¿™ä¸ªæŠ¥é”™å¯å¾—çŸ¥è¯¥é¡¹ç›®å±äºLinuxé¡¹ç›®ï¼Œæƒ³è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œï¼Œå°±éœ€è¦ä¿®æ”¹ä¸€ä¸‹package.jsonæ–‡ä»¶ä¸­çš„build
```html
//æŠŠ
"build": "astro check && astro build && pagefind --site dist && cp -r dist/pagefind public/"
//æ”¹æˆ
"build": "astro check && astro build && pagefind --site dist && xcopy dist\\pagefind public\\pagefind\\ /E /I /Y"
```
2. åœ¨éƒ¨ç½²é¡¹ç›®åˆ°vercelä¸Šæ—¶ï¼Œå¯èƒ½ä¼šé‡è§å¦‚ä¸‹æŠ¥é”™ï¼š
```html
[21:24:08.854] Running build in Washington, D.C., USA (East) â€“ iad1
[21:24:08.876] Cloning github.com/18050939892/my-new-blog (Branch: main, Commit: b84d64f)
[21:24:09.917] Previous build caches not available
[21:24:10.076] Cloning completed: 1.199s
[21:24:10.776] Running "vercel build"
[21:24:11.320] Vercel CLI 41.7.0
[21:24:12.214] Detected pnpm-lock.yaml 9 which may be generated by pnpm@9.x or pnpm@10.x
[21:24:12.215] Using pnpm@10.x based on project creation date
[21:24:12.215] To use pnpm@9.x, manually opt in using corepack (https://vercel.com/docs/deployments/configure-a-build#corepack)
[21:24:12.216] Running "install" command: npm install...
[21:24:27.539]
[21:24:27.540] added 667 packages, and audited 668 packages in 15s
[21:24:27.541]
[21:24:27.541] 220 packages are looking for funding
[21:24:27.542] run npm fund for details
[21:24:27.542]
[21:24:27.542] found 0 vulnerabilities
[21:24:28.088]
[21:24:28.089] > astro-paper@5.2.0 build
[21:24:28.090] > astro check && astro build && pagefind --site dist && xcopy dist\pagefind public\pagefind\ /E /I /Y
[21:24:28.090]
[21:24:32.178] 13:24:32 [content] Syncing content
[21:24:35.958] 13:24:35 [content] Synced content
[21:24:35.959] 13:24:35 [types] Generated 4.97s
[21:24:35.972] 13:24:35 [check] Getting diagnostics for Astro files in /vercel/path0...
[21:24:45.046] Result (48 files):
[21:24:45.046] - 0 errors
[21:24:45.048] - 0 warnings
[21:24:45.048] - 0 hints
[21:24:45.048]
[21:24:47.838] 13:24:47 [content] Syncing content
[21:24:47.892] 13:24:47 [content] Synced content
[21:24:47.893] 13:24:47 [types] Generated 688ms
[21:24:47.894] 13:24:47 [build] output: "static"
[21:24:47.895] 13:24:47 [build] mode: "static"
[21:24:47.895] 13:24:47 [build] directory: /vercel/path0/dist/
[21:24:47.895] 13:24:47 [build] Collecting build info...
[21:24:47.896] 13:24:47 [build] âœ“ Completed in 727ms.
[21:24:47.902] 13:24:47 [build] Building static entrypoints...
[21:24:51.295] 13:24:51 [vite] [32mâœ“ built in 3.34s[39m
[21:24:51.297] 13:24:51 [build] âœ“ Completed in 3.40s.
[21:24:51.297]
[21:24:51.297] building client (vite)
[21:24:51.313] 13:24:51 [vite] transforming...
[21:24:52.940] 13:24:52 [vite] [32mâœ“[39m 48 modules transformed.
[21:24:53.093] 13:24:53 [vite] rendering chunks...
[21:24:53.211] 13:24:53 [vite] computing gzip size...
[21:24:53.224] 13:24:53 [vite] [2mdist/[22m[2m_astro/[22m[36msearch.astro_astro_type_script_index_0_lang.DXnQTGL-.js [39m[1m[2m 2.14 kB[22m[1m[22m[2m â”‚ gzip: 1.07 kB[22m
[21:24:53.225] 13:24:53 [vite] [2mdist/[22m[2m_astro/[22m[36mindex.BVOCwoKb.js [39m[1m[2m 7.88 kB[22m[1m[22m[2m â”‚ gzip: 3.05 kB[22m
[21:24:53.225] 13:24:53 [vite] [2mdist/[22m[2m_astro/[22m[36mClientRouter.astro_astro_type_script_index_0_lang.BZs-2RF_.js [39m[1m[2m 14.70 kB[22m[1m[22m[2m â”‚ gzip: 5.02 kB[22m
[21:24:53.226] 13:24:53 [vite] [2mdist/[22m[2m_astro/[22m[36mComment.uImENI2E.js [39m[1m[2m 42.26 kB[22m[1m[22m[2m â”‚ gzip: 13.56 kB[22m
[21:24:53.226] 13:24:53 [vite] [2mdist/[22m[2m_astro/[22m[36mui-core.Bw3IIvrC.js [39m[1m[2m 68.07 kB[22m[1m[22m[2m â”‚ gzip: 21.71 kB[22m
[21:24:53.226] 13:24:53 [vite] [2mdist/[22m[2m_astro/[22m[36mclient.BPIbHqJh.js [39m[1m[2m179.41 kB[22m[1m[22m[2m â”‚ gzip: 56.60 kB[22m
[21:24:53.227] 13:24:53 [vite] [32mâœ“ built in 1.92s[39m
[21:24:53.252]
[21:24:53.253] generating static routes
[21:24:53.378] 13:24:53 Î» src/pages/og.png.ts
[21:24:54.660] 13:24:53 â””â”€ /og.png (+1.28s)
[21:24:54.680] 13:24:54 Î» src/pages/posts/[...slug]/index.png.ts
[21:24:54.902] 13:24:54 â”œâ”€ /posts/some-very-useful-websites/index.png (+200ms)
[21:24:55.065] 13:24:54 â”œâ”€ /posts/Compatibility-errors-encountered-when-using-astropaper/index.png (+163ms)
[21:24:55.231] 13:24:55 â”œâ”€ /posts/dynamic-og-image-generation-in-astropaper-blog-posts/index.png (+166ms)
[21:24:55.374] 13:24:55 â”œâ”€ /posts/customizing-astropaper-theme-color-schemes/index.png (+142ms)
[21:24:55.529] 13:24:55 â”œâ”€ /posts/common-commands-for-mongodb-database/index.png (+155ms)
[21:24:55.668] 13:24:55 â”œâ”€ /posts/astro-paperæ¡†æ¶ä¸‹çš„ç«‹å³å±•ç¤ºä¸æ›´æ–°å±•ç¤º/index.png (+139ms)
[21:24:55.874] 13:24:55 â”œâ”€ /posts/predefined-color-schemes/index.png (+206ms)
[21:24:56.081] 13:24:55 â”œâ”€ /posts/how-to-integrate-giscus-comments/index.png (+206ms)
[21:24:56.228] 13:24:56 â”œâ”€ /posts/how-to-add-latex-equations-in-blog-posts/index.png (+147ms)
[21:24:56.364] 13:24:56 â”œâ”€ /posts/astro-paperæ¡†æ¶ä¸­çš„ä¸€äº›ä½¿ç”¨æ³¨æ„äº‹é¡¹/index.png (+136ms)
[21:24:56.544] 13:24:56 â”œâ”€ /posts/request-promble/index.png (+180ms)
[21:24:56.678] 13:24:56 â”œâ”€ /posts/examples/how-do-i-develop-my-portfolio-and-blog/index.png (+134ms)
[21:24:56.807] 13:24:56 â”œâ”€ /posts/examples/tailwind-typography/index.png (+129ms)
[21:24:56.943] 13:24:56 â””â”€ /posts/examples/how-do-i-develop-my-terminal-portfolio-website-with-react/index.png (+135ms)
[21:24:56.981] 13:24:56 â–¶ src/pages/posts/[...page].astro
[21:24:57.006] 13:24:56 â”œâ”€ /posts/index.html (+22ms)
[21:24:57.017] 13:24:57 â”œâ”€ /posts/2/index.html (+12ms)
[21:24:57.024] 13:24:57 â”œâ”€ /posts/3/index.html (+6ms)
[21:24:57.031] 13:24:57 â”œâ”€ /posts/4/index.html (+7ms)
[21:24:57.037] 13:24:57 â””â”€ /posts/5/index.html (+5ms)
[21:24:57.039] 13:24:57 Î» src/pages/robots.txt.ts
[21:24:57.041] 13:24:57 â””â”€ /robots.txt (+1ms)
[21:24:57.059] 13:24:57 Î» src/pages/rss.xml.ts
[21:24:57.069] 13:24:57 â””â”€ /rss.xml (+10ms)
[21:24:57.075] 13:24:57 â–¶ src/pages/search.astro
[21:24:57.079] 13:24:57 â””â”€ /search/index.html (+4ms)
[21:24:57.097] 13:24:57 â–¶ src/pages/tags/index.astro
[21:24:57.106] 13:24:57 â””â”€ /tags/index.html (+9ms)
[21:24:57.112] 13:24:57 â–¶ src/pages/about.md
[21:24:57.115] 13:24:57 â””â”€ /about/index.html (+3ms)
[21:24:57.123] 13:24:57 â–¶ src/pages/archives/index.astro
[21:24:57.143] 13:24:57 â””â”€ /archives/index.html (+20ms)
[21:24:57.149] 13:24:57 â–¶ src/pages/tags/[tag]/[...page].astro
[21:24:57.158] 13:24:57 â”œâ”€ /tags/astro/index.html (+6ms)
[21:24:57.169] 13:24:57 â”œâ”€ /tags/blog/index.html (+10ms)
[21:24:57.175] 13:24:57 â”œâ”€ /tags/color-schemes/index.html (+7ms)
[21:24:57.181] 13:24:57 â”œâ”€ /tags/configuration/index.html (+6ms)
[21:24:57.185] 13:24:57 â”œâ”€ /tags/context-api/index.html (+4ms)
[21:24:57.196] 13:24:57 â”œâ”€ /tags/docs/index.html (+5ms)
[21:24:57.197] 13:24:57 â”œâ”€ /tags/docs/2/index.html (+7ms)
[21:24:57.206] 13:24:57 â”œâ”€ /tags/docs/3/index.html (+5ms)
[21:24:57.213] 13:24:57 â”œâ”€ /tags/faq/index.html (+5ms)
[21:24:57.213] 13:24:57 â”œâ”€ /tags/headless-cms/index.html (+4ms)
[21:24:57.214] 13:24:57 â”œâ”€ /tags/java-script/index.html (+3ms)
[21:24:57.223] 13:24:57 â”œâ”€ /tags/next-js/index.html (+10ms)
[21:24:57.227] 13:24:57 â”œâ”€ /tags/react-js/index.html (+4ms)
[21:24:57.236] 13:24:57 â”œâ”€ /tags/release/index.html (+8ms)
[21:24:57.239] 13:24:57 â”œâ”€ /tags/release/2/index.html (+4ms)
[21:24:57.244] 13:24:57 â”œâ”€ /tags/styled-components/index.html (+5ms)
[21:24:57.249] 13:24:57 â”œâ”€ /tags/tailwind-css/index.html (+5ms)
[21:24:57.254] 13:24:57 â””â”€ /tags/type-script/index.html (+4ms)
[21:24:57.263] 13:24:57 â–¶ src/pages/index.astro
[21:24:57.272] 13:24:57 â””â”€ /index.html (+9ms)
[21:24:57.279] 13:24:57 â–¶ src/pages/posts/[...slug]/index.astro
[21:24:57.292] 13:24:57 â”œâ”€ /posts/some-very-useful-websites/index.html (+11ms)
[21:24:57.316] 13:24:57 â”œâ”€ /posts/Compatibility-errors-encountered-when-using-astropaper/index.html (+24ms)
[21:24:57.331] 13:24:57 â”œâ”€ /posts/dynamic-og-image-generation-in-astropaper-blog-posts/index.html (+15ms)
[21:24:57.360] 13:24:57 â”œâ”€ /posts/how-to-update-dependencies/index.html (+29ms)
[21:24:57.372] 13:24:57 â”œâ”€ /posts/customizing-astropaper-theme-color-schemes/index.html (+12ms)
[21:24:57.377] 13:24:57 â”œâ”€ /posts/common-commands-for-mongodb-database/index.html (+5ms)
[21:24:57.385] 13:24:57 â”œâ”€ /posts/astro-paperæ¡†æ¶ä¸‹çš„ç«‹å³å±•ç¤ºä¸æ›´æ–°å±•ç¤º/index.html (+9ms)
[21:24:57.393] 13:24:57 â”œâ”€ /posts/predefined-color-schemes/index.html (+7ms)
[21:24:57.406] 13:24:57 â”œâ”€ /posts/how-to-integrate-giscus-comments/index.html (+12ms)
[21:24:57.411] 13:24:57 â”œâ”€ /posts/how-to-add-latex-equations-in-blog-posts/index.html (+5ms)
[21:24:57.421] 13:24:57 â”œâ”€ /posts/astro-paperæ¡†æ¶ä¸­çš„ä¸€äº›ä½¿ç”¨æ³¨æ„äº‹é¡¹/index.html (+10ms)
[21:24:57.427] 13:24:57 â”œâ”€ /posts/request-promble/index.html (+5ms)
[21:24:57.432] 13:24:57 â”œâ”€ /posts/astro-paper-2/index.html (+5ms)
[21:24:57.448] 13:24:57 â”œâ”€ /posts/astro-paper-v3/index.html (+15ms)
[21:24:57.454] 13:24:57 â”œâ”€ /posts/astro-paper-v4/index.html (+6ms)
[21:24:57.464] 13:24:57 â”œâ”€ /posts/astro-paper-v5/index.html (+10ms)
[21:24:57.471] 13:24:57 â”œâ”€ /posts/examples/how-do-i-develop-my-portfolio-and-blog/index.html (+7ms)
[21:24:57.478] 13:24:57 â”œâ”€ /posts/examples/tailwind-typography/index.html (+7ms)
[21:24:57.484] 13:24:57 â””â”€ /posts/examples/how-do-i-develop-my-terminal-portfolio-website-with-react/index.html (+5ms)
[21:24:57.484] 13:24:57 âœ“ Completed in 4.25s.
[21:24:57.485]
[21:24:57.485] generating optimized images
[21:24:57.646] 13:24:57 â–¶ /_astro/forrest-gump-quote.A3mC0z9n_xDi7o.webp (before: 274kB, after: 26kB) (+160ms) (1/4)
[21:24:58.097] 13:24:58 â–¶ /_astro/AstroPaper-v3.uaW8qzSG_ZbIc3B.webp (before: 168kB, after: 71kB) (+611ms) (2/4)
[21:24:58.172] 13:24:58 â–¶ /_astro/AstroPaper-v4.TylavUIc_2hhsBs.webp (before: 157kB, after: 70kB) (+526ms) (3/4)
[21:24:58.501] 13:24:58 â–¶ /_astro/AstroPaper-v5.BKHVI1Ox_1txTYb.webp (before: 173kB, after: 67kB) (+402ms) (4/4)
[21:24:58.502] 13:24:58 âœ“ Completed in 1.02s.
[21:24:58.502]
[21:24:58.529] 13:24:58 [@astrojs/sitemap] sitemap-index.xml created at dist
[21:24:58.529] 13:24:58 [build] 47 page(s) built in 11.36s
[21:24:58.530] 13:24:58 [build] Complete!
[21:24:58.657]
[21:24:58.657] Running Pagefind v1.3.0 (Extended)
[21:24:58.657] Running from: "/vercel/path0"
[21:24:58.658] Source: "dist"
[21:24:58.658] Output: "dist/pagefind"
[21:24:58.658]
[21:24:58.658] [Walking source directory]
[21:24:58.661] Found 47 files matching **/*.{html}
[21:24:58.661]
[21:24:58.661] [Parsing files]
[21:24:58.907] Found a data-pagefind-body element on the site.
[21:24:58.908] â†³ Ignoring pages without this tag.
[21:24:58.908]
[21:24:58.908] [Reading languages]
[21:24:58.910] Discovered 1 language: en
[21:24:58.910]
[21:24:58.910] [Building search indexes]
[21:24:58.926] Total:
[21:24:58.927] Indexed 1 language
[21:24:58.927] Indexed 19 pages
[21:24:58.927] Indexed 2349 words
[21:24:58.927] Indexed 0 filters
[21:24:58.927] Indexed 0 sorts
[21:24:58.953]
[21:24:58.953] Finished in 0.296 seconds
[21:24:58.962] sh: line 1: xcopy: command not found
[21:24:58.977] Error: Command "npm run build" exited with 127
[21:24:59.424]
[21:25:02.448] Exiting build container
```
è¿™æ˜¯å› ä¸ºé¡¹ç›®æ„å»ºæ—¶ç”¨åˆ°çš„xcopyå‘½ä»¤æ˜¯åŸºäºWindowsçš„ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€ç‚¹æ”¹çš„ç»“æœï¼Œè€Œ Vercel çš„æ„å»ºç¯å¢ƒæ˜¯åŸºäº Linuxçš„ï¼Œå› æ­¤
å¦‚æœä¸åªæ˜¯æ„å»ºé¡¹ç›®ï¼Œè¿˜è¦æŠŠé¡¹ç›®éƒ¨ç½²åˆ°vercelä¸Šçš„è¯ï¼Œå°±éœ€è¦ç»§ç»­æ”¹ï¼š
é¦–å…ˆç»§ç»­æ”¹buildé…ç½®
```html
"build": "astro check && astro build && pagefind --site dist && node scripts/copy-pagefind.js"

```
ç„¶ååˆ›å»ºæ–‡ä»¶ scripts/copy-pagefind.jsï¼Œå†…å®¹å¦‚ä¸‹ï¼š
```html
const fs = require('fs');
const path = require('path');
const { execSync } = require('child_process');

// æ£€æŸ¥æ“ä½œç³»ç»Ÿ
const isWindows = process.platform === 'win32';

try {
  // ç¡®ä¿ç›®æ ‡ç›®å½•å­˜åœ¨
  const publicDir = path.join(process.cwd(), 'public');
  const publicPagefindDir = path.join(publicDir, 'pagefind');
  
  if (!fs.existsSync(publicDir)) {
    fs.mkdirSync(publicDir, { recursive: true });
  }
  
  // æ ¹æ®æ“ä½œç³»ç»Ÿæ‰§è¡Œä¸åŒå‘½ä»¤
  if (isWindows) {
    execSync('xcopy dist\\pagefind public\\pagefind\\ /E /I /Y');
  } else {
    // å¦‚æœç›®æ ‡ç›®å½•å­˜åœ¨ï¼Œå…ˆåˆ é™¤
    if (fs.existsSync(publicPagefindDir)) {
      execSync('rm -rf public/pagefind');
    }
    execSync('cp -r dist/pagefind public/pagefind');
  }
  
  console.log('Successfully copied pagefind files');
} catch (error) {
  console.error('Error copying pagefind files:', error);
  process.exit(1);
}
```
å¦‚æ­¤ï¼Œä¾¿å¯è§£å†³å…¼å®¹é—®é¢˜äº†
